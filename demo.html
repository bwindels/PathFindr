<!DOCTYPE html>
<html>
    <head></head>
    <body>
        <canvas id="map"></canvas>
        <p id="stats"></p>
        <script src="util.js"></script>
        <script src="path.js"></script>
        <script src="graph.js"></script>
        <script src="squaregrid.js"></script>
        <script src="aanavmesh.js"></script>
        
        <script>
            (function() {
                var options = {
                    pixelsPerTile: 20,
                    borderWidth: 1,
                    debug: false
                };
                var obstacles = [
                    {x: 4, y: 0, height: 5},
                    {x: 1, y: 5, width: 4},
                    {x: 0, y: 7, width: 19, height: 2},
                    {x: 8, y: 2, height: 5},
                    {x: 12, y: 0, height: 5},
                    {x: 16, y: 2, height: 5},
                    {x: 12, y: 8, height: 5},
                    {x: 8, y: 9, height: 11},
                    {x: 8, y: 18, width: 11},
                    {x: 8, y: 18, width: 11}
                ];
                
                var grid = new PathFindr.SquareGrid(45, 25);
                obstacles.forEach(function(o) {
                    grid.addObstacle(o);
                });
                var startNode = grid.node(1, 2);
                var endNode = grid.node(1, 10);
                var start = new Date().getTime();
                var path = new PathFindr.Path(startNode, endNode, options);
                path.nodes();
                var time = (new Date().getTime() - start);
                var stats = document.getElementById('stats');
                stats.innerText = time+"ms";
                if(options.debug) {
                    stats.innerText = stats.innerText + 
                        ', openList: ' + path.openList.length + 
                        ', closedList: ' + path.closedList.length +
                        ', cost of path: ' + path.nodes()[path.nodes().length - 1].costFromStart();
                }
                var navMesh = new PathFindr.AANavMesh(grid);
                var canvas = document.getElementById('map');
                var map = new PathFindr.SquareGridCanvas(grid, canvas, options);
                
                map.drawRectangles(navMesh.rectangles)
                map.drawPath(path, 'orange');
                map.drawPath(new PathFindr.Path(grid.node(10,10), grid.node(1,20), options), 'green');
                map.drawPath(new PathFindr.Path(grid.node(40,1), grid.node(24,24), options), 'red');
                
                map.draw();
                
            })();
        </script>
    </body>
</html>